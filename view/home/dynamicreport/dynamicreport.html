{% extends "./../base.html" %} {%block title%}Dynamic Analysis{%endblock%} {% block header %}
<!-- Font Awesome -->
<link rel="stylesheet" href="/static/css/font-awesome.min.css">
<!-- Ionicons -->
<link rel="stylesheet" href="/static/css/ionicons.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="/static/dash/css/AdminLTE.min.css">
<link rel="stylesheet" href="/static/dash/css/skins/_all-skins.min.css">
<link rel="stylesheet" href="/static/css/style.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    
    <![endif]-->
<style>
    .skin-blue .sidebar-menu>li>a {
        color: #fff;
        background: #1e282c;
        border-left-color: #20a8d8;
    }
    
    .stick-header {
        position: sticky;
        top: 40px;
        z-index: 1000;
    }
    
    #apkinfo {
        color: black;
    }
    
    #echarts {
        height: 400px;
        margin-left: -15px;
        margin-right: -15px;
    }
    
    .echarts-item {
        height: 100%;
        /*background-color: white;*/
        /*padding: 0px;*/
    }
    
    #echarts-column,
    #echarts-pie {
        height: 100%;
        padding: 10px;
        background-color: white;
    }
    
    table,
    th,
    tr {
        border: 1px solid #eef1f6;
    }
    
    tr:hover {
        background-color: #eef1f6;
    }
    
    tr:hover .table-args,
    tr:hover .table-ret,
    tr:hover .table-time {
        border-left: 1px solid white;
    }
    
    thead {
        background-color: #eef1f6;
        top: 100px;
    }
    
    table {
        width: 100%;
    }
    
    th {
        text-align: center;
    }
    
    tr {
        height: 35px;
    }
    
    .table-method {
        width: 15%;
        text-align: center;
        word-break: break-all;
        padding: 4px 10px;
    }
    
    .table-args {
        width: 50%;
        padding: 4px 20px;
        line-height: 23px;
        word-break: break-all;
    }
    
    .table-time {
        width: 20%;
        padding: 4px 20px;
        line-height: 23px;
        text-align: center;
        word-break: break-all;
    }
    
    .table-ret {
        width: 15%;
        text-align: center;
    }
    
    .box-header {
        padding: 10px 25px;
    }
    
    .box-body {
        color: black;
    }
    
    .wrapper {
        overflow: visible;
    }
    
    .screenshotitem {
        /*width: 50%;*/
        display: inline-block;
        margin-left: 20px;
        margin-right: 20px;
    }
    
    .navbar {
        background-color: white !important;
        padding-left: 20px;
        padding-top: 10px;
    }
    
    .navbar p {
        font-weight: 800;
    }
    
    .main-header .logo {
        background-color: #49a2f5 !important;
    }
    
    .content {
        margin-top: 30px;
    }
    
    .treeview-menu {
        background: #27384f !important;
    }
    
    .header {
        background: #27384f !important;
        color: #66828e !important;
    }
    
    .sidebar-menu>li>a,
    .sidebar-menu>li.active>a {
        background: #1b2839 !important;
        border-left-color: #49a2f5;
    }

    .logo-lg {
        padding-top: 5px;
    }
</style>
{% endblock %} {% block content %}

<body class="skin-blue fixed" data-spy="scroll" data-target="#scrollspy">

    <div class="wrapper">

        <header class="main-header">
            <!-- Logo -->
            <a href="" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><b>Safe</b>Code</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><iframe src="/static/img/logo_all_white.svg" frameborder="0" width="200px" height="40px"></iframe></span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">

                <p style="margin-bottom: 0;font-size: 14px">移动互联网应用安全检测平台</p>
                <p style="margin-bottom: 0;font-size: 5px">SAFE-CODE MOBILE</p>
            </nav>
        </header>


        <script type="text/javascript" src="/static/js/shCore.js"></script>
        <script type="text/javascript" src="/static/echarts/echarts.min.js"></script>
        <script type="text/javascript" src="/static/js/shBrushJava.js"></script>
        <script src="/static/app/js/moment-with-locales.js"></script>
        <link type="text/css" rel="stylesheet" href="/static/css/shCoreDefault.css" />
        <style type="text/css" media="print">
            @page {
                size: landscape;
            }
        </style>
        <script type="text/javascript">
            SyntaxHighlighter.all();
        </script>

        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <div class="sidebar" id="scrollspy">

                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="nav sidebar-menu">
                    <li class="header">Dynamic Analysis</li>
                    <li class="treeview">
                        <a href="javascript::;"><i class="glyphicon glyphicon-phone"></i> API监控</a>
                        <ul class="nav treeview-menu">
                            <li><a href="#fileio"><i class="glyphicon glyphicon-file"></i> 文件读取</a></li>
                            <li><a href="#networkcalls"><i class="fa fa-plug"></i> 网络请求</a></li>
                            <li><a href="#bindercalls"><i class="fa fa-cubes"></i> 绑定请求</a></li>
                            <li><a href="#crypto"><i class="fa fa-flash"></i> 加密</a></li>
                            <li><a href="#deviceinfo"><i class="fa fa-info"></i> 设备信息</a></li>
                            <li><a href="#base64"><i class="fa fa-puzzle-piece"></i> Base64</a></li>
                            <li><a href="#content"><i class="fa fa-reorder"></i> 内容</a></li>
                            <li><a href="#sms"><i class="fa fa-comments"></i> 信息</a></li>
                            <li><a href="#devicedata"><i class="fa fa-phone"></i> 设备数据</a></li>
                            <li><a href="#dexclassloader"><i class="fa fa-asterisk"></i> Dex类加载</a></li>
                            <li><a href="#reflection"><i class="fa fa-object-ungroup"></i> 反射</a></li>
                            <li><a href="#systemmanager"><i class="fa fa-cogs"></i> 系统管理</a></li>
                            <li><a href="#process"><i class="fa fa-bar-chart-o"></i> 进程</a></li>
                        </ul>
                    </li>
                    <li><a href="#screenshots"><i class="fa fa-camera"></i> 屏幕截图</a></li>
                </ul>
            </div>
            <!-- /.sidebar -->
        </aside>

        <div id="app" class="content-wrapper">
            <!-- Content Header (Page header) -->
            <!-- Main content -->
            <template>

            
            <div class="content body">

                <!--overview-->
                <!--===============================================================-->
                <section id="apkinfo">
                    <div class="row">
                       

                        
                        <div class="col-sm-7">
                            <div class="box box-primary">
                                <div class="box-header with-border">
                                    <h3 class="box-title">文件信息</h3>
                                    <span class="label label-primary pull-right"><i
                                            class="glyphicon glyphicon-file"></i></span>
                                </div>
                                <!-- /.box-header -->
                                <div class="box-body">
                                    <div class="list-group">
                                        <p>
                                            <span class="label label-primary">报告类型</span> {{dynamicReport.autoinfo}}
                                        </p>
                                        <p>
                                            <span class="label label-primary">应用名称</span> {$apkinfo.label$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">应用大小</span> {$apkinfo.size$} MB
                                        </p>
                                        <p>
                                            <span class="label label-primary">检测引擎</span> {$mirrorimage$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">开始时间</span> {$createtime$}
                                            <span class="label label-primary">检测时长</span> {$lifetime$} min
                                        </p>

                                    </div>

                                </div>

                                <!-- /.box-body -->
                            </div>
                            <!-- /.box -->
                        </div>
                        <!-- /.col -->

                        <div class="col-sm-5">
                            <div class="box box-danger">
                                <div class="box-header with-border">
                                    <h3 class="box-title">应用信息</h3>
                                    <span class="label label-danger pull-right"><i class="glyphicon glyphicon-info-sign"></i></span>
                                </div>
                                <!-- /.box-header -->
                                <div class="box-body">
                                    <div class="list-group">
                                        <p>
                                            <span class="label label-primary">包名</span> {$apkinfo.packagename$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">主Activity</span> {$apkinfo.mainactivity$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">目标SDK</span> {$apkinfo.targetsdk$}
                                            <span class="label label-primary">Min SDK</span> {$apkinfo.minsdk$}
                                            <span class="label label-primary">Max SDK</span> {$apkinfo.maxsdk$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">版本名称</span> {$apkinfo.versionname$}
                                        </p>
                                        <p>
                                            <span class="label label-primary">版本号</span> {$apkinfo.versioncode$}
                                        </p>
                                    </div>

                                </div>
                                <!-- /.box-body -->
                            </div>
                            <!-- /.box -->
                        </div>
                       
                        <!-- /.col -->
                        <!---Components-->
                    </div>
                </section>
                <!-- ============================================================= -->
                <section id="echarts">
                    <div class="col-sm-6 echarts-item">
                        <div class="box" id="echarts-column"></div>
                    </div>
                    <div class="col-sm-6 echarts-item">
                        <div class="box" id="echarts-pie"></div>
                    </div>
                </section>

                <!--================================================================-->



                <!--========================================-->
                <section id="fileio">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header  alert-danger stick-header">
                            <h3 class="box-title"><i class="glyphicon glyphicon-file"></i>文件读取</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert" role="alert">
                                <table>
                                    <!--<div id="test" style="width: 100%;height: 60px;background-color: red;position: sticky;top: 0px ;z-index: 1000"></div>-->
                                    <thead v-if='fileio.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='fileinfo in fileio'>
                                            <td class="table-method">{$ fileinfo.mtd $}</td>
                                            <td class="table-args">{$ fileinfo.args $}</td>
                                            <td class="table-ret" v-if="fileinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ fileinfo.ret $}</td>
                                            <td class="table-time" v-if="fileinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ fileinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->



                <section id="networkcalls">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-danger stick-header">
                            <h3 class="box-title"><i class="fa fa-plug"></i> 网络请求</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert" role="alert">



                                <table>
                                    <thead v-if='networkcall.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='networkinfo in networkcall'>
                                            <td class="table-method">{$ networkinfo.mtd $}</td>
                                            <td class="table-args">{$ networkinfo.args $}</td>
                                            <td class="table-ret" v-if="networkinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ networkinfo.ret $}</td>
                                            <td class="table-time" v-if="networkinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ networkinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <!-- /.box-body -->

                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->



                <section id="bindercalls">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-danger stick-header">
                            <h3 class="box-title"><i class="fa fa-cubes"></i> 绑定请求</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <div class="alert" role="alert">


                                <table>
                                    <thead v-if='bindercall.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='binderinfo in bindercall'>
                                            <td class="table-method">{$ binderinfo.mtd $}</td>
                                            <td class="table-args">{$ binderinfo.args $}</td>
                                            <td class="table-ret" v-if="binderinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ binderinfo.ret $}</td>
                                            <td class="table-time" v-if="binderinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ binderinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->


                <section id="crypto">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-danger stick-header">
                            <h3 class="box-title"><i class="fa fa-flash"></i> 加密</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <div class="alert" role="alert">
                                <!--<a style="text-decoration: none" v-for='cryptoinfo in crypto'></br>METHOD: {$ cryptoinfo.mtd $}</br>ARGUMENTS: {$ cryptoinfo.args $}</br>RETURN DATA: <span v-if="cryptoinfo.ret">{$ cryptoinfo.ret $}</span><span v-else>No return data</span></br>
                            </a>-->

                                <table>
                                    <thead v-if='crypto.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='cryptoinfo in crypto'>
                                            <td class="table-method">{$ cryptoinfo.mtd $}</td>
                                            <td class="table-args">{$ cryptoinfo.args $}</td>
                                            <td class="table-ret" v-if="cryptoinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ cryptoinfo.ret $}</td>
                                            <td class="table-time" v-if="cryptoinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ cryptoinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->
                <section id="deviceinfo">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-warning stick-header">
                            <h3 class="box-title"><i class="fa fa-info"></i> 设备信息</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <div class="alert " role="alert">
                                <!--<a style="text-decoration: none" v-for='devinfo in deviceinfo'></br>METHOD: {$ devinfo.mtd $}</br>ARGUMENTS: {$ devinfo.args $}</br>RETURN DATA: <span v-if="devinfo.ret">{$ devinfo.ret $}</span><span v-else>No return data</span></br>
                                </a>-->

                                <table>
                                    <thead v-if='deviceinfo.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='devinfo in deviceinfo'>
                                            <td class="table-method">{$ devinfo.mtd $}</td>
                                            <td class="table-args">{$ devinfo.args $}</td>
                                            <td class="table-ret" v-if="devinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ devinfo.ret $}</td>
                                            <td class="table-time" v-if="devinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ devinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->
                <section id="base64">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-warning stick-header">
                            <h3 class="box-title"><i class="fa fa-puzzle-piece"></i> Base64</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">


                            <div class="alert " role="alert">


                                <table>
                                    <thead v-if='base64.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='baseinfo in base64'>
                                            <td class="table-method">{$ baseinfo.mtd $}</td>
                                            <td class="table-args">{$ baseinfo.args $}</td>
                                            <td class="table-ret" v-if="baseinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ baseinfo.ret $}</td>
                                            <td class="table-time" v-if="baseinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ baseinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>

                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->

                <section id="content">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-warning stick-header">
                            <h3 class="box-title"><i class="fa fa-reorder"></i> 内容</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <div class="alert" role="alert">

                                <table>
                                    <thead v-if='content.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='contentinfo in content'>
                                            <td class="table-method">{$ contentinfo.mtd $}</td>
                                            <td class="table-args">{$ contentinfo.args $}</td>
                                            <td class="table-ret" v-if="contentinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ contentinfo.ret $}</td>
                                            <td class="table-time" v-if="contentinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ contentinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->

                <section id="sms">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-warning stick-header">
                            <h3 class="box-title"><i class="fa fa-comments"></i> 信息</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert " role="alert">
                                <table>
                                    <thead v-if='sms.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='smsinfo in sms'>
                                            <td class="table-method">{$ smsinfo.mtd $}</td>
                                            <td class="table-args">{$ smsinfo.args $}</td>
                                            <td class="table-ret" v-if="smsinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ smsinfo.ret $}</td>
                                            <td class="table-time" v-if="smsinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ smsinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->

                <section id="devicedata">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-success stick-header">
                            <h3 class="box-title"><i class="fa fa-phone"></i>设备数据</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert" role="alert">
                                <table>
                                    <thead v-if='devicedata.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='devicedatainfo in devicedata'>
                                            <td class="table-method">{$ devicedatainfo.mtd $}</td>
                                            <td class="table-args">{$ devicedatainfo.args $}</td>
                                            <td class="table-ret" v-if="devicedatainfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ devicedatainfo.ret $}</td>
                                            <td class="table-time" v-if="devicedatainfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ devicedatainfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->


                <section id="dexclassloader">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-success stick-header">
                            <h3 class="box-title"><i class="fa fa-asterisk"></i> Dex类加载</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert " role="alert">

                                <table>
                                    <thead v-if='dexclassloader.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='dexclass in dexclassloader'>
                                            <td class="table-method">{$ dexclass.mtd $}</td>
                                            <td class="table-args">{$ dexclass.args $}</td>
                                            <td class="table-ret" v-if="dexclass.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ dexclass.ret $}</td>
                                            <td class="table-time" v-if="dexclass.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ dexclass.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->


                <section id="reflection">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-success stick-header">
                            <h3 class="box-title"><i class="fa fa-object-ungroup"></i> 反射</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert " role="alert">
                                <table>
                                    <thead v-if='reflection.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='efinfo in reflection'>
                                            <td class="table-method">{$ efinfo.mtd $}</td>
                                            <td class="table-args">{$ efinfo.args $}</td>
                                            <td class="table-ret" v-if="efinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ efinfo.ret $}</td>
                                            <td class="table-time" v-if="efinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ efinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->



                <section id="systemmanager">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-success stick-header">
                            <h3 class="box-title"><i class="fa fa-cogs"></i> 系统管理</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="alert " role="alert">


                                <table>
                                    <thead v-if='sysmanager.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='sysinfo in sysmanager'>
                                            <td class="table-method">{$ sysinfo.mtd $}</td>
                                            <td class="table-args">{$ sysinfo.args $}</td>
                                            <td class="table-ret" v-if="sysinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ sysinfo.ret $}</td>
                                            <td class="table-time" v-if="sysinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ sysinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->



                <section id="process">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header alert-success stick-header">
                            <h3 class="box-title"><i class="fa fa-bar-chart-o"></i> 进程</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <div class="alert " role="alert">


                                <table>
                                    <thead v-if='process.length>0'>
                                        <tr>
                                            <th class="table-method">方法</th>
                                            <th class="table-args">参数</th>
                                            <th class="table-ret">返回值</th>
                                            <th class="table-time">时间戳</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for='processinfo in process'>
                                            <td class="table-method">{$ processinfo.mtd $}</td>
                                            <td class="table-args">{$ processinfo.args $}</td>
                                            <td class="table-ret" v-if="processinfo.ret == 'No Return Data'">—</td>
                                            <td class="table-ret" v-else>{$ processinfo.ret $}</td>
                                            <td class="table-time" v-if="processinfo.timestamp == null">-</td>
                                            <td class="table-time" v-else>{$ processinfo.timestamp $}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>

                <section id="screenshots">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-camera"></i> 屏幕截图</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">

                            <span class="list-group screenshotitem" v-for="item in imgbase64">
                                <img alt="Screenshot" v-bind:src="item" class="img-thumbnail" height="600" width="350">
                            </span>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>

            </div>
            </template>
            <!-- /.content -->
        </div>






        <footer class="main-footer">
            <strong>© 2017 SafeCode Technology - SafeCode</strong>
        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Create the tabs -->
            <div class="pad">
                Console logs will be shown here.
            </div>
        </aside>
        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
         immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>

    </div>
    <!-- ./wrapper -->
</body>
{% endblock %} {% block js %}
<!-- FastClick -->
<script src="/static/plugins/fastclick/fastclick.min.js"></script>
<!-- AdminLTE App -->
<script src="/static/dash/js/app.min.js"></script>
<!-- SlimScroll 1.3.0 -->
<script src="/static/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- <script src="/static/js/run_prettify.js"></script>-->
<script src="/static/js/docs.js"></script>

<script>
    Vue.config.silent = false;
    var $vm = new Vue({
        el: '#app',
        delimiters: ['{$', '$}'],
        data: {
            fileio: [],
            networkcall: [],
            bindercall: [],
            crypto: [],
            deviceinfo: [],
            base64: [],
            content: [],
            sms: [],
            devicedata: [],
            dexclassloader: [],
            reflection: [],
            sysmanager: [],
            process: [],
            apkinfo: {},
            mirrorimage: '',
            createtime: '',
            lifetime: '',
            imgbase64: '',
        }
    });

    $.ajax({

        url: "/project/dynamicinfo",
        data: {
            sim: "{{dynamicReport.dynamic}}"
        },
        method: "GET",
        success: function(data) {
            // console.log(data);
            for (var info of data.data) {
                // if (info.timestamp != null) {
                //     info.timestamp = moment(new Date(info.timestamp)).format('YYYY-MM-DD HH:mm:ss');

                // }

                switch (info.type) {
                    case "API_FILEIO":

                        $vm.fileio.push(info);
                        console.log(info.ret);
                        break;
                    case "API_NET":
                        $vm.networkcall.push(info);
                        break;
                    case "API_BINDER":
                        $vm.bindercall.push(info);
                        break;
                    case "API_CRYPTO":
                        $vm.crypto.push(info);
                        break;
                    case "API_DEVICEINFO":
                        $vm.deviceinfo.push(info);
                        break;
                    case "API_BASE64":
                        $vm.base64.push(info);
                        break;
                    case "API_CNTVAL":
                        $vm.content.push(info);
                        break;
                    case "API_SMS":
                        $vm.sms.push(info);
                        break;
                    case "API_SYSPROP":
                        $vm.devicedata.push(info);
                        break;
                    case "API_DEXLOADER":
                        $vm.dexclassloader.push(info);
                        break;
                    case "API_REFLECT":
                        $vm.reflection.push(info);
                        break;
                    case "API_ACNTMNGER":
                        $vm.sysmanager.push(info);
                        break;
                    case "API_CMD":
                        $vm.process.push(info);
                    default:
                        break;
                }
            }

            renderColumnCharts();
            renderPieCharts();
            return;
        }
    })


    $.ajax({
        url: "/project/staticinfo",
        data: {
            apkinfoid: "{{dynamicReport.apkinfo}}",
        },
        method: "GET",
        success: function(data) {

            data.data[0].size = (data.data[0].size / 1024 / 1024).toFixed(2);
            $vm.apkinfo = data.data[0];

            return;
        }
    });
    $.ajax({
        url: "/project/mirrorimage",
        data: {
            projectid: "{{dynamicReport.projectid}}",
        },
        method: "GET",
        success: function(data) {
            $vm.mirrorimage = data.data;
            return;
        }
    });
    $.ajax({
        url: "/project/createanddead",
        data: {
            sim: "{{dynamicReport.dynamic}}",
        },
        method: "GET",
        success: function(data) {

            let createtime = moment(data.data[0].createtime).format('YYYY-MM-DD HH:mm:ss');
            $vm.createtime = createtime
            let lifetime = moment(data.data[0].deadlinetime).format('mm') - moment(data.data[0].createtime).format('mm');;
            $vm.lifetime = lifetime;


            return;
        }
    });
    $.ajax({
        url: "/project/screenshot",
        data: {
            sim: "{{dynamicReport.dynamic}}",
        },
        method: "GET",
        success: function(data) {
            $vm.imgbase64 = data.data;
            return;
        }
    })

    function renderColumnCharts() {
        let echarts_column = echarts.init(document.getElementById('echarts-column'));
        let option = {
            backgroundColor: '#FFFFFF', //背景色
            title: {
                text: 'API监测',
                subtext: ''
            },
            tooltip: {
                trigger: 'item',
                axisPointer: {
                    type: 'shadow'
                },
                formatter: function(params, ticket, callback) {
                    // console.log(params)
                    let res = params.name;
                    let value;
                    // if (params.value != 0) {
                    //     value = params.value - 1;
                    // } else {
                    //     value = params.value;
                    // }

                    res += '  ' + params.value;;
                    return res;
                }
            },

            grid: {
                left: '1%',
                right: '3%',
                bottom: '3%',
                containLabel: true
            },
            xAxis: {
                type: 'value',
                boundaryGap: [0, 0.01],

            },
            yAxis: {
                type: 'category',
                data: ['文件读取', '网络请求', '绑定请求', '加密', '设备信息', 'Base64', '内容', '信息', '设备数据', 'Dev类加载', '反射', '系统管理', '进程']
            },

            series: [{
                // name: 'API监控',
                // barMinHeight: '3',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: function(params) {
                            // build a color map as your need.
                            var colorList = [
                                '#C1232B', '#B5C334', '#FCCE10', '#E87C25', '#27727B',
                                '#FE8463', '#9BCA63', '#FAD860', '#F3A43B', '#60C0DD',
                                '#D7504B', '#C6E579', '#F4E001', '#F0805A', '#26C0C0'
                            ];
                            return colorList[params.dataIndex]
                        },
                        label: {
                            show: false,
                            formatter: '{b}\n{c}'
                        }
                    }
                },

                data: [$vm.fileio.length, $vm.networkcall.length, $vm.bindercall.length, $vm.crypto.length, $vm.deviceinfo.length, $vm.base64.length,
                    $vm.content.length, $vm.sms.length, $vm.devicedata.length, $vm.dexclassloader.length, $vm.reflection.length, $vm.sysmanager.length, $vm.process.length
                ],
                // data: [specialDisplay($vm.fileio.length), specialDisplay($vm.networkcall.length), specialDisplay($vm.bindercall.length), specialDisplay($vm.crypto.length), specialDisplay($vm.deviceinfo.length), specialDisplay($vm.base64.length),
                //     specialDisplay($vm.content.length), specialDisplay($vm.sms.length), specialDisplay($vm.devicedata.length), specialDisplay($vm.dexclassloader.length), specialDisplay($vm.reflection.length), specialDisplay($vm.sysmanager.length), specialDisplay($vm.process.length)
                // ],

            }]
        };
        echarts_column.setOption(option);
    }

    // function specialDisplay(length) {
    //     let temp = length;
    //     if (length > 0) {
    //         length += 1;
    //     }
    //     return length;

    // }

    function renderPieCharts() {
        let echarts_pie = echarts.init(document.getElementById('echarts-pie'));
        let option = {
            backgroundColor: '#ffffff',

            tooltip: {
                trigger: 'item',
                formatter: "{b}: {c} ({d}%)"
            },
            legend: {
                orient: 'vertical',
                x: 'left',
                data: ['文件读取', '网络请求', '帮顶请求', '加密', '设备信息', 'Base64', '内容', '信息', '设备数据', 'Dex类加载', '反射', '系统管理', '进程']
            },

            series: [{
                // name: '',
                type: 'pie',
                selectedMode: 'single',
                radius: [0, '30%'],

                label: {
                    normal: {
                        position: 'inner'
                    }
                },
                labelLine: {
                    normal: {
                        show: false
                    }
                },
                data: [{
                    value: $vm.fileio.length + $vm.networkcall.length + $vm.bindercall.length + $vm.crypto.length,
                    name: '高危',
                    // selected: true
                }, {
                    value: $vm.deviceinfo.length + $vm.base64.length + $vm.content.length + $vm.sms.length,
                    name: '中危'
                }, {
                    value: $vm.devicedata.length + $vm.dexclassloader.length +
                        $vm.reflection.length +
                        $vm.sysmanager.length +
                        $vm.process.length,
                    name: '低危'
                }]
            }, {
                // name: '',
                type: 'pie',
                radius: ['40%', '55%'],

                data: [{
                    value: $vm.fileio.length,
                    name: '文件读取'
                }, {
                    value: $vm.networkcall.length,
                    name: '网络请求'
                }, {
                    value: $vm.bindercall.length,
                    name: '绑定请求'
                }, {
                    value: $vm.crypto.length,
                    name: '加密'
                }, {
                    value: $vm.deviceinfo.length,
                    name: '设备信息'
                }, {
                    value: $vm.base64.length,
                    name: 'Base64'
                }, {
                    value: $vm.content.length,
                    name: '内容'
                }, {
                    value: $vm.sms.length,
                    name: '信息'
                }, {
                    value: $vm.devicedata.length,
                    name: '设备数据'
                }, {
                    value: $vm.dexclassloader.length,
                    name: 'dex类加载'
                }, {
                    value: $vm.reflection.length,
                    name: '反射'
                }, {
                    value: $vm.sysmanager.length,
                    name: '系统管理'
                }, {
                    value: $vm.process.length,
                    name: '进程'
                }]
            }],
            title: {
                text: 'API监测',
                subtext: '',
                x: 'right',
            }
        };
        echarts_pie.setOption(option);




        function eConsole(param) {
            // console.log(param.name);
            switch (param.name) {
                case '高危':
                    window.location = '#fileio';
                    break;
                case '中危':
                    window.location = '#deviceinfo';
                    break;
                case '低危':
                    window.location = '#devicedata';
                    break;
                case '文件读取':
                    window.location = '#fileio'
                    break;
                case '网络请求':
                    window.location = '#networkcalls'
                    break;
                case '绑定请求':
                    window.location = '#bindercalls'
                    break;
                case '加密':
                    window.location = '#crypto'
                    break;
                case '设备信息':
                    window.location = '#deviceinfo'
                    break;
                case 'Base64':
                    window.location = '#base64'
                    break;
                case '内容':
                    window.location = '#content'
                    break;
                case '信息':
                    window.location = '#sms'
                    break;
                case '设备数据':
                    window.location = '#devicedata'
                    break;
                case 'dex类加载':
                    window.location = '#dexclassloader'
                    break;
                case '反射':
                    window.location = '#reflection'
                    break;
                case '系统管理':
                    window.location = '#systemmanager'
                    break;
                case '进程':
                    window.location = '#process'
                    break;
                default:
                    break;
            }
        }
        echarts_pie.on('click', eConsole);

    }
</script>

{% endblock %}