{% extends "./../base.html" %} {%block title%}Static Analysis{%endblock%} {% block header %}
<!-- Font Awesome -->
<link rel="stylesheet" href="/static/css/font-awesome.min.css">
<!-- Ionicons -->
<link rel="stylesheet" href="/static/css/ionicons.min.css">
<!-- Theme style -->
<link rel="stylesheet" href="/static/dash/css/AdminLTE.min.css">
<link rel="stylesheet" href="/static/dash/css/skins/_all-skins.min.css">
<link rel="stylesheet" href="/static/css/style.css">
<link rel="stylesheet" href="/static/highlightjs/styles/default.css">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<style>
    .skin-blue .sidebar-menu>li>a {
        color: #fff;
        background: #1e282c;
        border-left-color: #20a8d8;
    }
    
    body {
        color: black;
        min-width: 800px;
        min-height: 800px;
    }
    
    div.clear {
        display: table;
        clear: both;
    }
    
    #nature .col-sm-4 {
        padding: 0;
    }
</style>
{% endblock %} {% block content %}
<!--<body class="skin-blue fixed" data-spy="scroll" data-target="#scrollspy">-->

<body class="skin-blue fixed" data-spy="scroll" data-target="#scrollspy">
    <div id="app" class="wrapper">


        <header class="main-header">
            <!-- Logo -->
            <a href="../" class="logo">
                <!-- mini logo for sidebar mini 50x50 pixels -->
                <span class="logo-mini"><b>Safe</b>Code</span>
                <!-- logo for regular state and mobile devices -->
                <span class="logo-lg"><b>Safe</b>Code</span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation">
                <!-- Sidebar toggle button-->
                <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">

                    <span class="sr-only">Toggle navigation</span>
                </a>
            </nav>
        </header>


        <!-- Left side column. contains the logo and sidebar -->
        <aside class="main-sidebar">
            <!-- sidebar: style can be found in sidebar.less -->
            <div class="sidebar" id="scrollspy">
                <!-- sidebar menu: : style can be found in sidebar.less -->
                <ul class="nav sidebar-menu">
                    <li class="header">Static Analysis</li>
                    <li class="active"><a href="#information"><i class="glyphicon glyphicon-info-sign"></i> 信息</a>
                    </li>
                    <li><a href="#nature"><i class="glyphicon glyphicon-tasks"></i> 代码表征</a></li>
                    <li><a href="#certificate"><i class="fa fa-certificate"></i> 签名证书</a></li>
                    <li><a href="#permissions"><i class="fa fa-align-justify"></i> 权限</a></li>
                    <li><a href="#manifest"><i class="fa fa-credit-card"></i> 配置文件</a></li>


                    <li class="treeview">
                        <a href="javascript::;"><i class="fa fa-bullseye"></i> 组件</a>
                        <ul class="nav treeview-menu">
                            <li><a href="#activities"><i class="fa fa-language"></i> 活动</a></li>
                            <li><a href="#services"><i class="fa fa-gears"></i> 服务</a></li>
                            <li><a href="#receivers"><i class="fa fa-sort-amount-desc"></i> 接收器</a></li>
                            <li><a href="#providers"><i class="fa fa-database"></i> 内容提供者</a></li>
                            <li><a href="#files"><i class="fa fa-files-o"></i> 文件</a></li>
                        </ul>
                    </li>
                    <li><a target="_blank" href="/staticreport/download?apkinfoid={{id}}"><i class="glyphicon glyphicon-list-alt"></i> 报告下载</a></li>

                </ul>
            </div>

            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <!-- Main content -->
            <div class="content body">

                <section id="information">
                    <h2 class="page-header"></h2>
                    <p class="lead">
                        <div class="row">
                            <div class="col-sm-7">
                                <div class="box box-primary">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">文件信息</h3>
                                        <span class="label label-primary pull-right"><i
                                            class="glyphicon glyphicon-file"></i></span>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <div class="list-group">
                                            <p>
                                                <span class="label label-primary">名称</span> {$apkInfo.label$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">大小</span> {$apkInfo.size$} MB
                                            </p>
                                            <p>
                                                <span class="label label-primary">MD5</span> {$apkInfo.md5$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">SHA1</span> {$apkInfo.sha1$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">SHA256</span> {$apkInfo.sha256$}
                                            </p>
                                        </div>

                                    </div>
                                    <!-- /.box-body -->
                                </div>
                                <!-- /.box -->
                            </div>
                            <!-- /.col -->

                            <div class="col-sm-5">
                                <div class="box box-danger">
                                    <div class="box-header with-border">
                                        <h3 class="box-title">应用信息</h3>
                                        <span class="label label-danger pull-right"><i class="glyphicon glyphicon-info-sign"></i></span>
                                    </div>
                                    <!-- /.box-header -->
                                    <div class="box-body">
                                        <div class="list-group">
                                            <p>
                                                <span class="label label-primary">包名</span> {$apkInfo.packagename$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">主活动</span> {$apkInfo.mainactivity$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">目标 SDK</span> {$apkInfo.targetsdk$}
                                                <span class="label label-primary">最低 SDK</span> {$apkInfo.minsdk$}
                                                <span class="label label-primary">最高 SDK</span> {$apkInfo.maxsdk$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">版本名称</span> {$apkInfo.versionname$}
                                            </p>
                                            <p>
                                                <span class="label label-primary">版本号</span> {$apkInfo.versioncode$}
                                            </p>
                                        </div>

                                    </div>
                                    <!-- /.box-body -->
                                </div>
                                <!-- /.box -->
                            </div>
                            <!-- /.col -->
                            <!---Components-->
                        </div>
                        <!-- /.row -->
                        <!-- Small boxes (Stat box) -->
                        <div class="row">
                            <div class="col-lg-3 col-xs-6">
                                <!-- small box -->
                                <div class="small-box bg-aqua">
                                    <div class="inner">
                                        <h3>{$apkInfo.activitiesnum$}</h3>

                                        <p>活动</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fa fa-language"></i>
                                    </div>
                                    <a href="#activities" class="small-box-footer">View <i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                            <!-- ./col -->
                            <div class="col-lg-3 col-xs-6">
                                <!-- small box -->
                                <div class="small-box bg-green">
                                    <div class="inner">
                                        <h3>{$apkInfo.servicesnum$}</h3>

                                        <p>服务</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fa fa-gears"></i>
                                    </div>
                                    <a href="#services" class="small-box-footer">View <i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                            <!-- ./col -->
                            <div class="col-lg-3 col-xs-6">
                                <!-- small box -->
                                <div class="small-box bg-yellow">
                                    <div class="inner">
                                        <h3>{$apkInfo.receiversnum$}</h3>

                                        <p>接收器</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fa fa-sort-amount-desc"></i>
                                    </div>
                                    <a href="#receivers" class="small-box-footer">View <i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                            <!-- ./col -->
                            <div class="col-lg-3 col-xs-6">
                                <!-- small box -->
                                <div class="small-box bg-red">
                                    <div class="inner">
                                        <h3>{$apkInfo.providersnum$}</h3>

                                        <p>内容提供者</p>
                                    </div>
                                    <div class="icon">
                                        <i class="fa fa-database"></i>
                                    </div>
                                    <a href="#providers" class="small-box-footer">View <i class="fa fa-arrow-circle-right"></i></a>
                                </div>
                            </div>
                            <!-- ./col -->
                        </div>
                        <!-- /.row -->

                        <!--Exported Components-->
                        <div class="row">

                            <div class="col-md-3 col-sm-6 col-xs-12">
                                <div class="info-box">
                                    <span class="info-box-icon bg-aqua"><i class="fa fa-language"></i></span>

                                    <div class="info-box-content">
                                        <span class="info-box-text">导出 </br>活动</span>
                                        <span class="info-box-number">{$apkInfo.exportedactivitiesnum$}</span>
                                    </div>
                                    <!-- /.info-box-content -->
                                </div>
                                <!-- /.info-box -->
                            </div>
                            <!-- /.col -->
                            <div class="col-md-3 col-sm-6 col-xs-12">
                                <div class="info-box">
                                    <span class="info-box-icon bg-green"><i class="fa fa-gears"></i></span>

                                    <div class="info-box-content">
                                        <span class="info-box-text">导出 </br>服务</span>
                                        <span class="info-box-number">{$apkInfo.exportedservicesnum$}</span>
                                    </div>
                                    <!-- /.info-box-content -->
                                </div>
                                <!-- /.info-box -->
                            </div>
                            <!-- /.col -->

                            <!-- fix for small devices only -->
                            <div class="clearfix visible-sm-block"></div>

                            <div class="col-md-3 col-sm-6 col-xs-12">
                                <div class="info-box">
                                    <span class="info-box-icon bg-yellow"><i class="fa fa-sort-amount-desc"></i></span>

                                    <div class="info-box-content">
                                        <span class="info-box-text">导出 </br>接收器</span>
                                        <span class="info-box-number">{$apkInfo.exportedreceiversnum$}</span>
                                    </div>
                                    <!-- /.info-box-content -->
                                </div>
                                <!-- /.info-box -->
                            </div>
                            <!-- /.col -->
                            <div class="col-md-3 col-sm-6 col-xs-12">
                                <div class="info-box">
                                    <span class="info-box-icon bg-red"><i class="fa fa-database"></i></span>

                                    <div class="info-box-content">
                                        <span class="info-box-text">导出 </br>内容提供者</span>
                                        <span class="info-box-number">{$apkInfo.exportedprovidersnum$}</span>
                                    </div>
                                    <!-- /.info-box-content -->
                                </div>
                                <!-- /.info-box -->
                            </div>
                            <!-- /.col -->
                        </div>
                        <!--End of Exported -->
                </section>
                <!-- /#introduction -->

                <section id="nature">
                    <h2 class="page-header"></h2>
                    <div class="col-sm-4">
                        <div class="box box-primary">
                            <div class="box-header with-border">
                                <h3 class="box-title">代码表征</h3>
                                <span class="label label-primary pull-right"><i class="glyphicon glyphicon-tasks"></i></span>
                            </div>
                            <!-- /.box-header -->
                            <div class="box-body">
                                <div class="list-group">
                                    <p>
                                        <span class="label label-primary">原生</span>
                                        <a v-if="rnativeData == 0">不存在</a>
                                        <a v-else>存在</a>
                                    </p>
                                    <p>
                                        <span class="label label-primary">动态</span>
                                        <a v-if="dynamicData == 0">不存在</a>
                                        <a v-else>存在</a>
                                    </p>
                                    <p>
                                        <span class="label label-primary">反射</span>
                                        <a v-if="reflectData == 0">不存在</a>
                                        <a v-else>存在</a>
                                    </p>
                                    <p>
                                        <span class="label label-primary">加密</span>
                                        <a v-if="cryptoData == 0">不存在</a>
                                        <a v-else>存在</a>
                                    </p>
                                    <p>
                                        <span class="label label-primary">混淆</span>
                                        <a v-if=" obfusData == 0">不存在</a>
                                        <a v-else>存在</a>
                                    </p>
                                </div>
                            </div>
                            <!-- /.box-body -->
                        </div>
                        <!-- /.box -->
                    </div>

                    <div class="clear"></div>
                </section>



                <!-- ============================================================= -->
                <!-- ============================================================= -->

                <section id="certificate">
                    <h2 class="page-header"></h2>
                    <div class="box-header">
                        <!-- /.box-header -->
                        <h3 class="box-title"><i class="fa fa-certificate"></i> 签名证书</h3>
                    </div>
                    <pre class="hierarchy bring-up"><code >{$apkInfo.signercertificate$}
        <strong>签名状态: </strong><span v-if="apkInfo.certissued == 'good'" class="label label-success">Good</span><span v-if="apkInfo.certissued == 'missing'" class="label label-danger">Missing</span><span v-if="apkInfo.certissued == 'broken'" class="label label-danger">Broken</span><span v-if="apkInfo.certissued == 'bad'" class="label label-warning">Bad</span>
        <!--其他情况-->
</code></pre>
                </section>


                <!-- ============================================================= -->

                <!-- ============================================================= -->


                <section id="permissions">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <!-- /.box-header -->
                            <h3 class="box-title"><i class="fa fa-align-justify"></i> 权限</h3>
                        </div>
                        <div class="box-body no-padding">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover table-striped">
                                    <thead>
                                        <tr>
                                            <th>权限</th>
                                            <th>状态</th>
                                            <th>信息</th>
                                            <th>描述</th>

                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr v-for="permission of permissions">
                                            <td>{$ permission.permName $}</td>
                                            <td>
                                                <span v-if="permission.status == 'normal'" class="label label-info">normal</span>
                                                <span v-if="permission.status == 'dangerous'" class="label label-danger">dangerous</span>
                                                <span v-if="permission.status == 'signature'" class="label label-warning">signature</span>
                                                <span v-if="permission.status == 'signatureOrSystem'" class="label label-warning">signatureOrSystem</span>
                                                <span v-if="permission.status == 'signature|development|appop'" class="label label-warning">signature|development|appop</span>
                                                <span v-if="permission.status == 'signature|system'" class="label label-warning">signature|system</span>
                                                <span v-if="permission.status == 'signature|system|development'" class="label label-warning">signature|system|development</span>
                                                <span v-if="permission.status == 'system|signature'" class="label label-warning">system|signature</span>
                                            </td>
                                            <td>{$ permission.info $}</td>
                                            <td>
                                                {$ permission.description $}
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                            </div>

                            <!-- /.box-body -->
                        </div>
                        <!-- /.box -->
                    </div>
                </section>


                <!-- ============================================================= -->
                <section id="manifest">
                    <h2 class="page-header"></h2>
                    <div class="box-header">
                        <!-- /.box-header -->
                        <h3 class="box-title"><i class="fa fa-credit-card"></i> 配置文件</h3>
                    </div>
                    <pre class="bring-up" id='manifestcode'><code class="html">{$ apkInfo.manifest $}
    </code></pre>
                </section>
                <!-- ============================================================= -->

                <section id="activities">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-language"></i> 活动</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="list-group">
                                <p v-for='activity in activities'>{$ activity $}</p>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>


                <!-- ============================================================= -->

                <section id="services">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-gears"></i> 服务</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="list-group">
                                <p v-for='service in services'>{$ service $}</p>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>

                <!-- ============================================================= -->

                <section id="receivers">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-sort-amount-desc"></i> 广播接收器</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="list-group">
                                <p v-for='receiver in receivers'>{$ receiver $}</p>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>

                <!-- ============================================================= -->

                <section id="providers">
                    <h2 class="page-header"></h2>

                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-database"></i> 内容提供者</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="list-group">
                                <p v-for='provider in providers'>{$ provider $}</p>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>

                <!-- ============================================================= -->

                <section id="files">
                    <h2 class="page-header"></h2>
                    <!-- /.box -->

                    <div class="box">
                        <div class="box-header">
                            <h3 class="box-title"><i class="fa fa-files-o"></i> 文件</h3>
                        </div>
                        <!-- /.box-header -->
                        <div class="box-body">
                            <div class="list-group">
                                <p v-for='file in files'>{$ file $}</p>
                            </div>
                        </div>
                        <!-- /.box-body -->
                    </div>
                    <!-- /.box -->
                </section>
            </div>
            <!-- /.content -->
        </div>
        <!-- /.content-wrapper -->


        <footer class="main-footer">
            <strong>© 2017 SafeCode Technology - SafeCode </strong>
        </footer>

        <!-- Control Sidebar -->
        <aside class="control-sidebar control-sidebar-dark">
            <!-- Create the tabs -->
            <div class="pad">
                Console logs will be shown here.
            </div>
        </aside>
        <!-- /.control-sidebar -->
        <!-- Add the sidebar's background. This div must be placed
     immediately after the control sidebar -->
        <div class="control-sidebar-bg"></div>

    </div>
    <!-- ./wrapper -->
</body>
{% endblock %} {% block js %}
<!-- FastClick -->
<script src="/static/plugins/fastclick/fastclick.min.js"></script>
<!-- AdminLTE App -->
<script src="/static/dash/js/app.min.js"></script>
<!-- SlimScroll 1.3.0 -->
<script src="/static/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- <script src="/static/js/run_prettify.js"></script>-->
<script src="/static/js/docs.js"></script>
<script src="/static/highlightjs/highlight.pack.js"></script>
<script>
    Vue.config.silent = false;
    var $vm = new Vue({
        el: '#app',
        delimiters: ['{$', '$}'],
        data: {
            apkInfo: {},
            activities: [],
            services: [],
            receivers: [],
            providers: [],
            files: [],
            permissions: [],
            dynamicData: {},
            cryptoData: {},
            obfusData: {},
            reflectData: {},
            rnativeData: {},

        },
        updated: function() {

            $('#manifestcode code').each(function(i, block) {
                hljs.highlightBlock(block);
            });

        }
    });
    $.ajax({
        url: "/project/staticinfo",
        data: {
            apkinfoid: "{{id}}"
        },
        method: "GET",
        success: function(data) {
            // console.log(data);
            let permissions;
            data.data[0].size = (data.data[0].size / 1024 / 1024).toFixed(2);

            $vm.apkInfo = data.data[0];




            $vm.activities = JSON.parse($vm.apkInfo.activities);
            $vm.services = JSON.parse($vm.apkInfo.services);
            $vm.receivers = JSON.parse($vm.apkInfo.receivers);
            $vm.providers = JSON.parse($vm.apkInfo.providers);
            $vm.files = JSON.parse($vm.apkInfo.files);
            $vm.dynamicData = $vm.apkInfo.dynamic.data[0];
            $vm.cryptoData = $vm.apkInfo.crypto.data[0];
            $vm.obfusData = $vm.apkInfo.obfus.data[0];
            $vm.reflectData = $vm.apkInfo.reflect.data[0];
            $vm.rnativeData = $vm.apkInfo.rnative.data[0];


            permissions = JSON.parse($vm.apkInfo.permissions);

            $.ajax({
                url: "/permission/staticpermission",
                data: {
                    permissions: $vm.apkInfo.permissions
                },
                method: "GET",
                success: function(data) {
                    $vm.permissions = data.data;
                },


            });

            return;
        }
    });
</script>


{% endblock %}